;; mimic common lisp cond syntax
(fn cond [...]
  (local clauses [...])
  (if (= clauses nil)
      nil
      (let [body []]
        (each
          [_ clause (ipairs clauses)]
          (if (not (= (length clause) 2))
              (error "cond clauses must be pairs")
              (do
                (table.insert body (. clause 1))
                (table.insert body (. clause 2)))))
        `(if ,(table.unpack body)))))